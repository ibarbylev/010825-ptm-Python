# Модуль `collections`

Это стандартный модуль Python, который предоставляет альтернативные структуры данных  
к встроенным типам (list, dict, tuple, set), с дополнительной функциональностью.  
Он упрощает работу с данными и делает код более читаемым и эффективным.

## 1. `OrderedDict`
   
Словарь, который запоминает порядок добавления элементов (более корректно, чем обычный dict).  

Поддерживает все методы `dict`, плюс два дополнительных метода:

* `move_to_end(key, last=True)` — перемещает элемент в конец или начало,
* `popitem(last=True)` — удаляем пару из конца (`last=True`) или начала (`last=False`)

---

## 2. `Counter`

Counter — это подкласс словаря (`dict)`, специально предназначенный для подсчёта количества   
вхождений элементов в коллекции (например, в списке, строке или другом итерируемом объекте).

Каждый элемент хранится как ключ, а количество его вхождений — как значение.

`Counter` принимает итерированную последовательность и возвращает отсортированный по убыванию словарь,  
где 
ключи - элементы итерированной последовательности
значения - частота их повторений

```python
from collections import Counter

iterable_object = ['a','b','a','c','a','b']
c = Counter(iterable_object)
print(c)                 # Counter({'a': 3, 'b': 2, 'c': 1})
print(c.most_common(2))  # [('a', 3), ('b', 2)]
```

### Основные методы `Counter`

#### 1. `most_common([n])`

Возвращает список из `n` самых частых элементов и их счётчиков.
Если `n` не указано — возвращает все элементы, отсортированные по убыванию частоты.

```python
c = Counter('abracadabra')
print(c.most_common(3))
# [('a', 5), ('b', 2), ('r', 2)]
```
#### 2. `elements()`

Возвращает итератор по элементам, повторённым столько раз, сколько их количество.
Элементы возвращаются в порядке, не обязательно упорядоченном.

```python
c = Counter(a=3, b=2, c=1)
print(list(c.elements()))
# ['a', 'a', 'a', 'b', 'b', 'c']
```

#### 3. Арифметические операции

`Counter` поддерживает операции между экземплярами:

* `+` — суммирует значения, отбрасывая отрицательные и нулевые
* `-` — вычитает (отбрасывая отрицательные)
* `&` — берёт минимальные значения для каждого ключа
* `|` — берёт максимальные значения для каждого ключа

```python
c1 = Counter(a=3, b=1)
c2 = Counter(a=1, b=2, c=1)

print(c1 + c2)  # Counter({'a': 4, 'b': 3, 'c': 1})
print(c1 - c2)  # Counter({'a': 2})
print(c1 & c2)  # Counter({'a': 1, 'b': 1})
print(c1 | c2)  # Counter({'a': 3, 'b': 2, 'c': 1})
```

---

## 3. `defaultdict`

Словарь с автоматическим значением по умолчанию для отсутствующих ключей.  
В качестве аргумента может быть только callable объект (например, функция)

**Примеры:**

* `defaultdict(int)` → по умолчанию `0`
* `defaultdict(list)` → по умолчанию `[]`

```python
from collections import defaultdict
from random import randint


dd = defaultdict(int)  # callable  __call__()
dd['a'] += 1
print(dd)       # defaultdict(<class 'int'>, {'a': 1})
print(dd['a'])  # 1
print(dd['b'])  # 0, ключ 'b' создаётся автоматически


def random_int():
    return randint(0, 100)

dict_random = defaultdict(random_int)
print(dict_random['a'])
print(dict(dict_random))

print(dict_random['b'])
print(dict(dict_random))

print(dict_random['c'])
print(dict(dict_random))
# {'a': 71}
# 16
# {'a': 71, 'b': 16}
# 62
# {'a': 71, 'b': 16, 'c': 62}
```
### Сходство с `setdefault`

И тот, и другой создают новую пару при отсутствии ключа.

### Отличие от `setdefault`

| Параметр                                | `setdefault`                                                                                | `defaultdict`                                                                |
|-----------------------------------------|---------------------------------------------------------------------------------------------|------------------------------------------------------------------------------|
| **Как задаётся значение по умолчанию**  | Вызовом метода на месте: `dict.setdefault(key, default_value)`                              | Передаётся **callable** при создании: `defaultdict(default_factory)`         |
| **Когда срабатывает**                   | Только при явном вызове `d.setdefault(key)` <br>если просто вызвать `d[key]` - не сработает | Автоматически при каждом обращении к отсутствующему ключу `d[key]`           |
| **Тип значения по умолчанию**           | Любое конкретное значение (объект)                                                          | Всегда результат вызова `callable`, можно генерировать новый объект каждый раз |
| **Пример синтаксиса**                   | `d.setdefault('a', [])`                                                                     | `dd = defaultdict(list)`                                                     |

---

## 4. `namedtuple`

Именованный тюпл

```python
from collections import namedtuple
Point = namedtuple('Point', ['x', 'y'])
p = Point(10, 20)
print(p.x, p.y)  # 10 20
```

